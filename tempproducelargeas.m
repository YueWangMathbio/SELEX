% produce A_1>200 and S_T>200 approximations for SELEX

clear all
close all

ss=[230,260,300,350,400,450,500,600,700,800,...
    900,1000,1200,1400,1600,1800,2000,2300,2600,3000,3500,4000,...
    4500,5000,6000,7000,8000,9000,10000,12000,14000,16000,18000,...
    20000,23000,26000,30000,35000,40000,45000,50000,60000,70000,...
    80000,90000,100000,120000,140000,160000,180000,200000,230000,...
    260000,300000,350000,400000,450000,500000,600000,700000,800000,...
    900000,1000000];
ls=length(ss);

for i=1:ls
    for j=1:ls

        n1=ss(i);
        n2=n1*10;
        s=ss(j);
        q=0.001;
        ar=roots([q -q*s+2*q*n1-1 -2*q*n1*n2-q*n2*n2-n2 q*s*n2*n2]);
        v=min(ar(ar>0));
        u=2*n1*v/(n2+v);
        r1=u/(u+v);
        r2=2*r1/(2*r1+1-r1);
        r3=2*r2/(2*r2+1-r2);
        B1(i,j)=r1;
        B2(i,j)=r2;
        B3(i,j)=r3;
    end
end
save B1.dat B1 -ascii;
save B2.dat B2 -ascii;
save B3.dat B3 -ascii;



